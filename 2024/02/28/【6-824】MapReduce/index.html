<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="format-detection" content="telephone=no"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><link rel="icon" href="/images/icons/favicon-16x16.png?v=2.8.0" type="image/png" sizes="16x16"><link rel="icon" href="/images/icons/favicon-32x32.png?v=2.8.0" type="image/png" sizes="32x32"><meta name="description" content="Paper main idea        1234567891011121314151617Figure 1 shows the overall flow of a MapReduce operation in our implementation. When the user program calls the MapReduce function,">
<meta property="og:type" content="article">
<meta property="og:title" content="【6.824】MapReduce">
<meta property="og:url" content="http://example.com/2024/02/28/%E3%80%906-824%E3%80%91MapReduce/index.html">
<meta property="og:site_name" content="Ziyang&#39;s Blog">
<meta property="og:description" content="Paper main idea        1234567891011121314151617Figure 1 shows the overall flow of a MapReduce operation in our implementation. When the user program calls the MapReduce function,">
<meta property="og:locale">
<meta property="og:image" content="http://example.com/images/map_reduce.png">
<meta property="article:published_time" content="2024-02-28T10:45:33.000Z">
<meta property="article:modified_time" content="2024-02-28T14:19:05.412Z">
<meta property="article:author" content="Zhen Ziyang">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/images/map_reduce.png"><title>【6.824】MapReduce | Ziyang's Blog</title><link ref="canonical" href="http://example.com/2024/02/28/%E3%80%906-824%E3%80%91MapReduce/"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.12.1/css/all.min.css" type="text/css"><link rel="stylesheet" href="/css/index.css?v=2.8.0"><link rel="stylesheet" href="css/custom.css"><script>var Stun = window.Stun || {};
var CONFIG = {
  root: '/',
  algolia: undefined,
  assistSearch: undefined,
  fontIcon: {"prompt":{"success":"fas fa-check-circle","info":"fas fa-arrow-circle-right","warning":"fas fa-exclamation-circle","error":"fas fa-times-circle"},"copyBtn":"fas fa-copy"},
  sidebar: {"offsetTop":"20px","tocMaxDepth":6},
  header: {"enable":true,"showOnPost":true,"scrollDownIcon":false},
  postWidget: {"endText":true},
  nightMode: {"enable":true},
  back2top: {"enable":true},
  codeblock: {"style":"default","highlight":"light","wordWrap":false},
  reward: false,
  fancybox: false,
  zoomImage: {"gapAside":"20px"},
  galleryWaterfall: undefined,
  lazyload: false,
  pjax: undefined,
  externalLink: {"icon":{"enable":true,"name":"fas fa-external-link-alt"}},
  shortcuts: undefined,
  prompt: {"copyButton":"Copy","copySuccess":"Copy Success","copyError":"Copy Error"},
  sourcePath: {"js":"js","css":"css","images":"images"},
};

window.CONFIG = CONFIG;</script><meta name="generator" content="Hexo 7.1.1"></head><body><div class="container" id="container"><header class="header" id="header"><div class="header-inner"><nav class="header-nav header-nav--fixed"><div class="header-nav-inner"><div class="header-nav-menubtn"><i class="fas fa-bars"></i></div><div class="header-nav-menu"><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/"><span class="header-nav-menu-item__icon"><i class="fas fa-home"></i></span><span class="header-nav-menu-item__text">Home</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/archives/"><span class="header-nav-menu-item__icon"><i class="fas fa-folder-open"></i></span><span class="header-nav-menu-item__text">Archives</span></a></div></div><div class="header-nav-mode"><div class="mode"><div class="mode-track"><span class="mode-track-moon"></span><span class="mode-track-sun"></span></div><div class="mode-thumb"></div></div></div></div></nav><div class="header-banner"><div class="header-banner-info"><div class="header-banner-info__title">Hello Stun</div><div class="header-banner-info__subtitle">An elegant theme for Hexo</div></div></div></div></header><main class="main" id="main"><div class="main-inner"><div class="content-wrap" id="content-wrap"><div class="content" id="content"><!-- Just used to judge whether it is an article page--><div id="is-post"></div><div class="post"><header class="post-header"><h1 class="post-title">【6.824】MapReduce</h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">Created</span><span class="post-meta-item__value">2024-02-28</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">Updated</span><span class="post-meta-item__value">2024-02-28</span></span><span class="post-meta-item post-meta-item--visitors"><span class="post-meta-item__icon"><i class="fas fa-eye"></i></span><span class="post-meta-item__info">Visited</span><span class="post-meta-item__value" id="busuanzi_value_page_pv"></span></span></div></header><div class="post-body">
        <h1 id="Paper-main-idea"   >
          <a href="#Paper-main-idea" class="heading-link"><i class="fas fa-link"></i></a><a href="#Paper-main-idea" class="headerlink" title="Paper main idea"></a>Paper main idea</h1>
      <p><img src="/images/map_reduce.png"></p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">Figure 1 shows the overall flow of a MapReduce operation in our implementation. When the user program calls the MapReduce function, the following sequence of actions occurs (the numbered labels in Figure 1 correspond to the numbers in the list below): </span><br><span class="line"></span><br><span class="line">1. The MapReduce library in the user program first splits the input files into M pieces of typically 16 megabytes to 64 megabytes (MB) per piece (controllable by the user via an optional parameter). It then starts up many copies of the program on a cluster of machines. </span><br><span class="line"></span><br><span class="line">2. One of the copies of the program is special – the master. The rest are workers that are assigned work by the master. There are M map tasks and R reduce tasks to assign. The master picks idle workers and assigns each one a map task or a reduce task. </span><br><span class="line"></span><br><span class="line">3. A worker who is assigned a map task reads the contents of the corresponding input split. It parses key/value pairs out of the input data and passes each pair to the user-defined Map function. The intermediate key/value pairs produced by the Map function are buffered in memory</span><br><span class="line"></span><br><span class="line">4. Periodically, the buffered pairs are written to local disk, partitioned into R regions by the partitioning function. The locations of these buffered pairs on the local disk are passed back to the master, who is responsible for forwarding these locations to the reduce workers. </span><br><span class="line"></span><br><span class="line">5. When a reduce worker is notified by the master about these locations, it uses remote procedure calls to read the buffered data from the local disks of the map workers. When a reduce worker has read all intermediate data, it sorts it by the intermediate keys so that all occurrences of the same key are grouped together. The sorting is needed because typically many different keys map to the same reduce task. If the amount of intermediate data is too large to fit in memory, an external sort is used. </span><br><span class="line"></span><br><span class="line">6. The reduce worker iterates over the sorted intermediate data and for each unique intermediate key encountered, it passes the key and the corresponding set of intermediate values to the user&#x27;s Reduce function. The output of the Reduce function is appended to a final output file for this reduce partition</span><br><span class="line"></span><br><span class="line">7. When all map tasks and reduce tasks have been completed, the master wakes up the user program. At this point, the MapReduce call in the user program returns back to the user code.</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></div></figure>


        <h1 id="论文的youtube讲解"   >
          <a href="#论文的youtube讲解" class="heading-link"><i class="fas fa-link"></i></a><a href="#论文的youtube讲解" class="headerlink" title="论文的youtube讲解"></a>论文的youtube讲解</h1>
      <p><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://www.google.com/search?q=map+reduce+bilibili&sca_esv=573962864&biw=1527&bih=744&tbm=vid&sxsrf=AM9HkKmLsPQM2n0qHvQp-24bArEzuViXPQ:1697548678192&ei=hokuZZSsC8HO1e8PrN2EsA8&ved=0ahUKEwiUh8_Plf2BAxVBZ_UHHawuAfYQ4dUDCA0&uact=5&oq=map+reduce+bilibili&gs_lp=Eg1nd3Mtd2l6LXZpZGVvIhNtYXAgcmVkdWNlIGJpbGliaWxpMggQABiJBRiiBDIFEAAYogQyCBAAGIkFGKIESP8OUK0BWJYNcAB4AJABAJgByQKgAY0SqgEHMC4yLjcuMbgBA8gBAPgBAcICBBAjGCfCAggQABjLARiABMICBRAAGIAEwgIHEAAYigUYQ8ICCBAAGB4YDxgKwgIIEAAYCBgeGArCAggQABgIGB4YE8ICBxAhGKABGAqIBgE&sclient=gws-wiz-video#fpstate=ive&vld=cid:b5108df6,vid:Rz8JCS9TfOQ,st:0" >https://www.google.com/search?q=map+reduce+bilibili&amp;sca_esv=573962864&amp;biw=1527&amp;bih=744&amp;tbm=vid&amp;sxsrf=AM9HkKmLsPQM2n0qHvQp-24bArEzuViXPQ%3A1697548678192&amp;ei=hokuZZSsC8HO1e8PrN2EsA8&amp;ved=0ahUKEwiUh8_Plf2BAxVBZ_UHHawuAfYQ4dUDCA0&amp;uact=5&amp;oq=map+reduce+bilibili&amp;gs_lp=Eg1nd3Mtd2l6LXZpZGVvIhNtYXAgcmVkdWNlIGJpbGliaWxpMggQABiJBRiiBDIFEAAYogQyCBAAGIkFGKIESP8OUK0BWJYNcAB4AJABAJgByQKgAY0SqgEHMC4yLjcuMbgBA8gBAPgBAcICBBAjGCfCAggQABjLARiABMICBRAAGIAEwgIHEAAYigUYQ8ICCBAAGB4YDxgKwgIIEAAYCBgeGArCAggQABgIGB4YE8ICBxAhGKABGAqIBgE&amp;sclient=gws-wiz-video#fpstate=ive&amp;vld=cid:b5108df6,vid:Rz8JCS9TfOQ,st:0</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>

        <h1 id="some-ideas"   >
          <a href="#some-ideas" class="heading-link"><i class="fas fa-link"></i></a><a href="#some-ideas" class="headerlink" title="some ideas"></a>some ideas</h1>
      
        <h2 id="Task-Synchronous"   >
          <a href="#Task-Synchronous" class="heading-link"><i class="fas fa-link"></i></a><a href="#Task-Synchronous" class="headerlink" title="Task Synchronous:"></a>Task Synchronous:</h2>
      <p>all map task should be earlier than reduce task! </p>
<p>some map task may wait seconds, so should first all map tasks done before reduce.</p>

        <h2 id="Lock"   >
          <a href="#Lock" class="heading-link"><i class="fas fa-link"></i></a><a href="#Lock" class="headerlink" title="Lock:"></a>Lock:</h2>
      <p>workers run parallel, should add mutex to filelist when </p>

        <h2 id="Error-Return"   >
          <a href="#Error-Return" class="heading-link"><i class="fas fa-link"></i></a><a href="#Error-Return" class="headerlink" title="Error Return:"></a>Error Return:</h2>
      <p>workers may run some error, such as <code>rpc sock connect</code> and <code>can not open files</code>. When these errors happend, should return <code>Error</code> to master, other than just stop itself.</p>

        <h2 id="Heartbeat"   >
          <a href="#Heartbeat" class="heading-link"><i class="fas fa-link"></i></a><a href="#Heartbeat" class="headerlink" title="Heartbeat:"></a>Heartbeat:</h2>
      <p>master should ask workers whether they are alive.</p>
<p>Implementation method:</p>
<ol>
<li>Set a new scheduled task and ask every 2 minutes.</li>
<li>Every time a new worker requests a new task, add a judgment when rotating all tasks to assign tasks to the worker. If a task status is not Finish and times out, the task fails</li>
<li>Write in the <code>Done()</code> method and continuously rotate to ensure that all tasks are completed. And take the opportunity to determine if there is a task timeout.</li>
</ol>
<p>Performance comparison: 1&gt;2&gt;3</p>
<p>Judging by frequency. The execution frequency of 3 is too high, constantly executing and discussing the sequence.</p>

        <h1 id="status-of-task-and-worker"   >
          <a href="#status-of-task-and-worker" class="heading-link"><i class="fas fa-link"></i></a><a href="#status-of-task-and-worker" class="headerlink" title="status of task and worker"></a>status of task and worker</h1>
      <p>worker: </p>
<ul>
<li>Finish: worker finish task X</li>
<li>Ready: worker ask for a new task</li>
<li>Wrong: worker meet some problems</li>
<li>Close: worker will be closed when master ask worker to close</li>
</ul>
<p>task:</p>
<ul>
<li>Run: some worker is running on this task</li>
<li>Done: this task is finished</li>
<li>(empty string): task not be allocated yet</li>
</ul>
</div><footer class="post-footer"><div class="post-ending ending"><div class="ending__text">------ END ------</div></div><div class="post-copyright copyright"><div class="copyright-author"><span class="copyright-author__name">Author: </span><span class="copyright-author__value"><a href="http://example.com">Zhen Ziyang</a></span></div><div class="copyright-link"><span class="copyright-link__name">Link: </span><span class="copyright-link__value"><a href="http://example.com/2024/02/28/%E3%80%906-824%E3%80%91MapReduce/">http://example.com/2024/02/28/%E3%80%906-824%E3%80%91MapReduce/</a></span></div><div class="copyright-notice"><span class="copyright-notice__name">Copyright: </span><span class="copyright-notice__value">All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en" rel="external nofollow" target="_blank">BY-NC-SA</a> unless stating additionally</span></div></div><nav class="post-paginator paginator"><div class="paginator-prev"><a class="paginator-prev__link" href="/2024/02/28/%E5%A6%82%E4%BD%95%E4%B8%8D%E5%81%9A%E5%B1%80%E5%A4%96%E4%BA%BA/"><span class="paginator-prev__icon"><i class="fas fa-angle-left"></i></span><span class="paginator-prev__text">如何own好项目，不做局外人</span></a></div><div class="paginator-next"><a class="paginator-next__link" href="/2024/02/28/raft/"><span class="paginator-prev__text">【6.824】raft</span><span class="paginator-next__icon"><i class="fas fa-angle-right"></i></span></a></div></nav></footer></div></div></div><div class="sidebar-wrap" id="sidebar-wrap"><aside class="sidebar" id="sidebar"><div class="sidebar-nav"><span class="sidebar-nav-toc current">Catalog</span><span class="sidebar-nav-ov">Overview</span></div><section class="sidebar-toc"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Paper-main-idea"><span class="toc-number">1.</span> <span class="toc-text">
          Paper main idea</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%AE%BA%E6%96%87%E7%9A%84youtube%E8%AE%B2%E8%A7%A3"><span class="toc-number">2.</span> <span class="toc-text">
          论文的youtube讲解</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#some-ideas"><span class="toc-number">3.</span> <span class="toc-text">
          some ideas</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Task-Synchronous"><span class="toc-number">3.1.</span> <span class="toc-text">
          Task Synchronous:</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Lock"><span class="toc-number">3.2.</span> <span class="toc-text">
          Lock:</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Error-Return"><span class="toc-number">3.3.</span> <span class="toc-text">
          Error Return:</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Heartbeat"><span class="toc-number">3.4.</span> <span class="toc-text">
          Heartbeat:</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#status-of-task-and-worker"><span class="toc-number">4.</span> <span class="toc-text">
          status of task and worker</span></a></li></ol></section><!-- ov = overview--><section class="sidebar-ov hide"><div class="sidebar-ov-author"><div class="sidebar-ov-author__avatar"><img class="sidebar-ov-author__avatar_img" src="/images/icons/stun-logo.svg" alt="avatar"></div><p class="sidebar-ov-author__text">Hello Stun</p></div><div class="sidebar-ov-state"><a class="sidebar-ov-state-item sidebar-ov-state-item--posts" href="/archives/"><div class="sidebar-ov-state-item__count">12</div><div class="sidebar-ov-state-item__name">Archives</div></a></div><div class="sidebar-ov-cc"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en" target="_blank" rel="noopener" data-popover="Creative Commons" data-popover-pos="up"><img src="/images/cc-by-nc-sa.svg"></a></div></section><div class="sidebar-reading"><div class="sidebar-reading-info"><span class="sidebar-reading-info__text">You have read </span><span class="sidebar-reading-info__num">0</span><span class="sidebar-reading-info__perc">%</span></div><div class="sidebar-reading-line"></div></div></aside></div><div class="clearfix"></div></div></main><footer class="footer" id="footer"><div class="footer-inner"><div><span>Copyright © 2024</span><span class="footer__icon"><i class="fas fa-heart"></i></span><span>Zhen Ziyang</span><span class="footer__devider">|</span><span></span></div><div><span>Theme - <a href="https://github.com/liuyib/hexo-theme-stun/" title="Stun" target="_blank" rel="noopener">Stun</a></span><span> v2.8.0</span></div><div class="busuanzi"><span class="busuanzi-siteuv"><span class="busuanzi-siteuv__icon"><i class="fas fa-user"></i></span><span class="busuanzi-siteuv__info">Visitors</span><span class="busuanzi-siteuv__value" id="busuanzi_value_site_uv"></span></span><span class="busuanzi-sitepv"><span class="busuanzi-siteuv__icon"><i class="fas fa-eye"></i></span><span class="busuanzi-siteuv__info">Views</span><span class="busuanzi-siteuv__value" id="busuanzi_value_site_pv"></span></span></div></div></footer><div class="loading-bar" id="loading-bar"><div class="loading-bar__progress"></div></div><div class="back2top" id="back2top"><span class="back2top__icon"><i class="fas fa-rocket"></i></span></div></div><script src="https://cdn.jsdelivr.net/npm/jquery@v3.4.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.ui.min.js"></script><script src="https://cdn.jsdelivr.net/gh/sukkaw/busuanzi@latest/bsz.pure.mini.js" async></script><script src="/js/utils.js?v=2.8.0"></script><script src="/js/stun-boot.js?v=2.8.0"></script><script src="/js/scroll.js?v=2.8.0"></script><script src="/js/header.js?v=2.8.0"></script><script src="/js/sidebar.js?v=2.8.0"></script></body></html>